<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="/../css/itempage.css">
  <!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"> -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
    integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />



  </style>
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css">
  <link href='https://unpkg.com/css.gg@2.0.0/icons/css/coffee.css' rel='stylesheet'>
  <link href='https://unpkg.com/css.gg@2.0.0/icons/css/edit-fade.css' rel='stylesheet'>
  <link href='https://unpkg.com/css.gg@2.0.0/icons/css/arrow-left-o.css' rel='stylesheet'>
  <link href='https://unpkg.com/css.gg@2.0.0/icons/css/maximize.css' rel='stylesheet'>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/../css/cartsidebar.css">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <style>
    .material-symbols-outlined {
      position: relative;
      top: 1px;
      font-variation-settings:
        'FILL' 0,
        'wght' 400,
        'GRAD' 0,
        'opsz' 48
    }
  </style>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <title>FRNTR</title>
</head>
<body>
    <%- include("./partials/nav.ejs")%>
    <div class="Main">
        <div class="topnav">
          <div class="container1">
            <div class="leftnav">
              <nav class="naav">
                <a href="/">Home</a>
                <i class="fa fa-chevron-right"></i>
                <a href="/product/clientproduct/?category=<%=product.category%>"><%=product.category%></a>
                <i class="fa fa-chevron-right"></i>
                <span><%= product.productName%></span>
              </nav>
            </div>
    
            <div class="rightnav">
    
              <a href="/product/clientproduct/?category=<%=product.category%>"><i class="material-symbols-outlined">
                  grid_view
                </i></a>
    
              <a href="#"> <i class="fa fa-chevron-right"></i></a>
            </div>
          </div>
        </div>
      </div>
    
      <section>
        <div class="product">
          <div class="left-side">
            <div class="left-img">
              <% if (product.photo && product.photo.length > 0) { %> <% product.photo.forEach((path,index)=>
                { %>
              <div class="images">
                <img id="image<%= index + 1 %>"src="<%= path %>" alt="pic-1" width="700" height="700">
              </div>
              <% }); %>
                <% } %>
            </div>
    
    
          </div>
    
          <div class="right-side">
            <div class="right">
              <div class="h1-price">
                <h1><%=product.productName%></h1>
                <div class="price">
                  <% if(product.offer) {%>
                    <del><%= product.price %>EGP</del>
                    <ins class="in"><%= product.price -(product.price * (product.offer)/100) %> EGP</ins>
                    <span>SAVE <%=product.offer%>%</span>
                    <%} else {%>
                      <ins class="in" style="color:black"><%= product.price %>EGP</ins>
                      <%}%>
                
                  
                </div>
              </div>
              <div class="tabbyPromo">
                <div class="tabbyframe">
                  <span>4 payments of
                    <strong>1,952.50 EGP</strong>
                    . No interest. No fees. <a href="#">Learn more</a></span>
                </div>
              </div>
              <div class="popup" id="popup">
                <img src="/images/404-tick.png" alt="tick">
                <h2>Added To Cart!</h2>
                <p>Item has been added to cart successfully. Thanks!</p>
                <button type="button" onclick="closePopup()">OK</button>
            </div>
            <div class="errorpopup" id="errorpopup">
              <img src="/images/404-error.png" alt="tick">
              <h2>Failed to add to cart!</h2>
              <p>Item out of stock!</p>
              <button type="button" onclick="closeerrorPopup()">OK</button>
          </div>
              <div class="sympl-widget">
                <div class="paragraph">
                  <span>Pay over 5 payments of <strong style="color: #ff395a">1171.5 EGP </strong>with your
                    bank
                    card.</span>
                  <span><strong style="font-weight: bold;">0 interest. 0 registration.</strong><a href="#">learn
                      more.</a></span>
                  <span class="hint">(amount may vary)</span>
                </div>
                <img src="https://assets.sympl.ai/widgets/ecom-prod-dtls/assets/sympl-logo.svg" alt="Sympl logo">
              </div>
              <div class="payment">
                <div class="add-to-cart">
                  <div class="color-section">
                   <div class="colordiv">
                    <h4 class="color-title"><span>Color:<span><%=product.color%></span> </span></h4>
                    <div class="colorproducts">
                      <% if (product.photo && product.photo.length> 0) { %> <% product.photo.forEach((path,index)=>
                        { %>
                      <div class="cp">
                        <a href="#image<%= index + 1 %>"><img src="<%=path%>" alt=""></a>
                      </div>
                      <% }); %>
                      <% } %>
                    </div>
                   </div>
                  </div>
                  <div class="Row">
                  <div class="row1">
                    <div class="addone">
                      <button class="mins" onclick="decrement()"><i class="fa fa-minus"></i></button>
                      <span class="number" id="myNumber"></span>
                      <button class="plus" onclick="increment()"><i class="fa fa-plus"></i></button>
                    </div>

                    <% if(user!==""){%>
                    <button class="button-addto" onclick="addToCart(`<%=product._id%>` , `<%=product.productName%>` , `<%=product.price%>`, `<%=product.quantity%>` , document.getElementById(`myNumber`).innerText)"> <span class="">Add to cart</span></button>
                    <button class="buttonxxx" onclick="addToWishlist(`<%=product._id%>` , `<%=product.productName%>` , `<%=product.price%>`, `<%=product.quantity%>` )" > <a><i class="material-symbols-outlined" >
                        favorite </i></a></button>
                      <%}else{%>
                        
                        <button class="button-addto" > <span class="">Login to Add to Cart</span></button>

                        

                        <a href="#"><i class="material-symbols-outlined">
                            favorite
                          </i></a>
                          <%}%>
                          
                  </div>
                  <div class="row2">
                    <button class="buy"onclick="addToCart(`<%=product._id%>` , `<%=product.productName%>` , `<%=product.price%>`, `<%=product.quantity%>` , document.getElementById(`myNumber`).innerText)">Buy it now</button>
                  </div>
                </div>
              </div>
              </div>
              <div class="info-images">
                <img src="/images/CVH33.webp" alt="" class="images">
              </div>
              <div class="description">
               <%=product.comments%>
    
               
                <h4>
                  <br>
                  <strong>Weights &amp; Dimensions</strong>
                </h4>
  
                <p>
                  <%=product.category%>:<%=product.size%>
                </p>
                <p>
                  <img src="<%=product.photo[0]%>" alt="" class="images" width="705" height="602">
                </p>
              </div>
    
              <div class="extra-link">
                <a href="#">Delivery & Return</a>
                <a href="#">Ask a Question</a>
              </div>
    
              <div class="product-details">
                <div class="type">
                  <span>Type: <a href="/product/clientproduct/?category=<%=product.category%>"><%=product.category%></a></span>
                </div>
                <div class="availabile">
                  <span>Availability : <span>In Stock</span>
                </div>
    
                <div class="categories">
                  <span>Categories: <a href="/product/clientproduct/?category=<%=product.category%>"><%=product.category%></a></span>
                </div>
              </div>
    
              <div class="social-media-row">
                <div class="icon-row">
                  <div class="button">
                    <div class="icon">
                      <a href="#" target="_blank"> <i class="fab fa-facebook-f"></i></a>
                      <span class="tooltiptext">Follow on Facebook</span>
                    </div>
                  </div>
    
    
                  <div class="button">
                    <div class="icon">
                      <a href="#" target="_blank"> <i class="fab fa-instagram"></i></a>
                      <span class="tooltiptext">Follow on Instagram</span>
                    </div>
                  </div>
    
                  <div class="button">
                    <div class="icon">
                      <a href="#" target="_blank"> <i class="fab fa-linkedin"></i></a>
                      <span class="tooltiptext">Follow on Linkedin</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="reviews">
            <div class="reviews-cont">
              <div class="accordion">
                <div class="contentBox">
                  <div class="label">
                    <span class="titlee">Review</span>
                    <span class="iconp"><i class="fa-solid fa-plus"></i></span>
                  </div>
                  <div class="conteent">
                    <div class="review-bottom">
                      <div class="review-bottom-1"> 
                        <%if(user.userType==='client'){%>
                        <div class="rate">
                          <span class="stars-rate">
                            <ul>
                              <li><i class="fa-regular fa-star" style="color: #f08e05;"></i></li>
                              <li><i class="fa-regular fa-star" style="color: #f08e05;"></i></li>
                              <li><i class="fa-regular fa-star" style="color: #f08e05;"></i></li>
                              <li><i class="fa-regular fa-star" style="color: #f08e05;"></i></li>
                              <li><i class="fa-regular fa-star" style="color: #f08e05;"></i></li>
                            </ul>
                          </span>
                        </div>
                       
                        <button class="review-btn" onclick="showReviewForm()">Write a review</button>
                        
                        <div class="popupp">
                          <form id="review-form" method="POST" action="/product/review" style="display: none;">
                           <input type="hidden" name="id" value="<%=product._id%>">
                           <input type="hidden" name="category" value="<%=product.category%>">
                            <label for="review-text"> Leave a review for the ( <%= product.productName%> )</label>
                            <textarea id="review-text" name="review" placeholder="Enter your review here:"></textarea>
                            <button type="submit">Submit</button> 
                            <button id="close-button">Close</button>
                          </form>
                        </div>

                        <button class="review-btn" ><i class="fa fa-sliders"></i></button>
                      </div>
                      <h5>FeedBack</h5>
                      <% if (product.approved && product.approved.length > 0) { %>
                        <% product.approved.forEach((apprev, index) => { %>
                          <div class="rev-link">
                            <ul>
                              <li>
                                <span>Review(<span><%= index + 1 %></span>): </span>
                                <%= apprev %>
                              </li>
                            </ul>
                          </div> 
                        <% }) %>
                      <% } %>
                      
                    <%} else{%>
                      <h5 style="text-align: center;">FeedBack of Clients:</h5>
                      <% if (product.approved && product.approved.length > 0) { %>
                        <% product.approved.forEach((apprev, index) => { %>
                          <div class="rev-link">
                            <ul>
                              <li>
                                <span>Review(<span><%= index + 1 %></span>): </span>
                                <%= apprev %>
                              </li>
                            </ul>
                          </div> 
                        <% }) %>
                      <% } %>
                       <%}%>
                  </div>
                </div>
              </div>
    
            </div>
      </section>
    
      <div class="moreproducts">
        <div class="innerprod">
          <div class="top-header">
            <h3 class="title">
    
              <span>You may also like</span>
    
            </h3>
          </div>
          <div class="viewproduct">
            <div class="row">
              <% products.forEach((prod) => { %>
              <div class="col-md-3">
                <div class="products">
                  <div class="product-image">
                    <% if (prod.photo && prod.photo.length > 0) { %>
                    <a href="/product/itempage?id=<%= prod._id %>&category=<%= prod.category %>" class="images">
                      <img src="<%= prod.photo[0]%>" alt="" class="pic-1">
                      <img src="<%= prod.photo[1]%>" alt="" class="pic-2">
                    </a>
                    <% } %>
                    <% if(prod.offer){%>
                    <span class="discount"><%=prod.offer%>%</span>
                       <%}else{%>
                        <span class="discount" style="display: none;"></span>
                        <%}%>
                   
                    </div>
    
                  </div>
                  <div class="Content">
                    <h3 class="product-title">
                    <%=prod.productName%>
                    </h3>
                    <% if(prod.offer) {%>
                    <del><%=prod.price%> EGP</del>
                    <ins class="in"> <%= prod.price -(prod.price * (prod.offer)/100) %> EGP</ins>
                    <%} else {%>
                      <ins class="in" style="color:#333"> <%= prod.price %> EGP</ins>
                      <%}%>
                  </div>
                </div>
              </div>
    
              <% }) %>

     
      <script src="/../js/itemPage.js"></script>
       <script type="text/javascript"  src="/js/ajax-cart.js"></script>
      <script type="text/javascript"  src="/js/ajax-wishlist.js"></script>
      <script>
        let popup = document.getElementById("popup");

function openPopup(){
    popup.classList.add("open-popup");
}


function closePopup(){
    popup.classList.remove("open-popup");
}
      async function addToWishlist(productid, productname , productprice , productQuantity) {
  console.log("in ajax wishlist");
    console.log(productid, productname, productprice, productQuantity, "done");

      product = {
      productId: productid,
      productName: productname,
      productPrice: productprice,
      productQuantity: productQuantity,
       }
      console.log(product);
                $.ajax({
                  url:'/user/add-to-wishlist',
                  method:'POST',
                  contentType: 'application/json',
                  data:JSON.stringify({ productId: productid, productName:productname,
                  productPrice: productprice, productQuantity: productQuantity}),
                  success:function(response){
                   //$('#result').html(response);
                  },
                  error:function(err){}
                })
            }

      </script>

      <%- include("./partials/chat.ejs")%>
      <%- include("./partials/footer.ejs")%>
</body>
</html>